% Copyright EPFL-LSP
% Derived from version 2005 (R.D Hersch / F. Crété)
% xyzBarIlluminants.m   % EP, RDH, 1.3.03
% Lists the xbar, ybar and zbar values at 10nm intervals well as the spectra
% of the D65 and A illuminants and the RGBtoXYZ and XYZtoRGB matrices
% file to be inserted into main program by writing a new line with xyzBarScale; 

global xbar ybar zbar D65 matRGB_2_XYZ matXYZ_2_RGB

%____________________________________________________________________
% Colour-matching curves                                             
%____________________________________________________________________
% _          _          _                                            
% x(lambda), y(lambda), z(lambda)                                    
%  see: Hunt p.608 or Wyszecki, Stiles p.736 
%  Range: 380 - 730 nm, step 10 nm, 36 discrete values
xbar = [0.0014, 0.0042, 0.0143, 0.0435, 0.1344, 0.2839, 0.3483, 0.3362, 0.2908,...
        0.1954, 0.0956, 0.0320, 0.0049, 0.0093, 0.0633, 0.1655, 0.2904, 0.4334,...
        0.5945, 0.7621, 0.9163, 1.0263, 1.0622, 1.0026, 0.8544, 0.6424, 0.4479,...
        0.2835, 0.1649, 0.0874, 0.0468, 0.0227, 0.0114, 0.0058, 0.0029, 0.0014];
        
ybar = [0.0000, 0.0001, 0.0004, 0.0012, 0.0040, 0.0116, 0.0230, 0.0380, 0.0600,...
        0.0910, 0.1390, 0.2080, 0.3230, 0.5030, 0.7100, 0.8620, 0.9540, 0.9950,...
        0.9950, 0.9520, 0.8700, 0.7570, 0.6310, 0.5030, 0.3810, 0.2650, 0.1750,...
        0.1070, 0.0610, 0.0320, 0.0170, 0.0082, 0.0041, 0.0021, 0.0010, 0.0005];
        
zbar = [0.0065, 0.0201, 0.0679, 0.2074, 0.6456, 1.3856, 1.7471, 1.7721, 1.6692,...
        1.2876, 0.813,  0.4652, 0.272,  0.1582, 0.0782, 0.0422, 0.0203, 0.0087,...
        0.0039, 0.0021, 0.0017, 0.0011, 0.0008, 0.0003, 0.0002, 0.,     0.,    ...
        0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.,     0.    ];


%____________________________________________________________________
% CIE Standard Light Sources A and D65                               
% Source: Hunt, pp. 612-613                                          
%____________________________________________________________________

% Range: 380 - 730 nm, step 10 nm, 36 discrete values
stdIlluminantA = ... 
       [9.8,   12.09,   14.71,  17.68,  20.99,  24.67,  28.7,   33.09,  37.81,... 
        42.87, 48.24,   53.91,  59.86,  66.06,  72.5,   79.13,  85.95,  92.91,...
        100.,  107.18,  114.44, 121.73, 129.04, 136.35, 143.62, 150.84, 157.98,...
        165.03, 171.96, 178.77, 185.43, 191.93, 198.26, 204.41, 210.36, 216.12];

D65 = ...
       [49.98,  54.65,  82.75,  91.49,  93.43,  86.68,  104.86, 117.01, 117.81,...
        114.86, 115.92, 108.81, 109.35, 107.8,  104.79, 107.69, 104.41, 104.05,...
        100.,   96.33,  95.79,  88.69,  90.01,  89.6,   87.7,   83.29,  83.7,  ...
        80.03,  80.21,  82.28,  78.28,  69.72,  71.61,  74.35,  61.6,   69.89 ];
TL84 =...
    [0; 0; 1.2900;1.5900;2.4600;4.4900;12.1300;7.1900;6.7200;5.4600;5.6600;14.9600;...
    4.7200;1.4700;0.8900;1.1800;39.5900;32.6100;2.8300;1.6700;11.2800;12.7300;...
    7.3300;55.2700;13.1800;12.2600;2.0700;3.5800;2.4800;1.5400;1.4600;2.0000;1.3500; 0; 0; 0]';
D50=[24.490000	29.870000	49.310000	56.510000	60.030000	57.820000	74.820000	87.250000	90.610000	91.370000	95.110000	91.960000	95.720000	96.610000	97.130000	102.100000	100.750000	102.320000	100.000000	97.740000	98.920000	93.500000	97.690000	99.270000	99.040000	95.720000	98.860000	95.670000	98.190000	103.000000	99.130000	87.380000	91.600000	92.890000	76.850000	86.510000];


%____________________________________________________________________
% RGB <--> XYZ transformation matrices
%____________________________________________________________________
% matrixA
matRGB_2_XYZ = [[21.915,    17.1703,	 11.128 ],
                [11.6,		37.7,		 4.28   ], 
                [1.21557,	7.34092,	 62.4102]];

% matrixB
matXYZ_2_RGB = [[0.0595688,  -0.0254014,  -0.00887939 ],
	            [-0.0184434, 0.0347489,   0.000905517 ], 
                [0.00100916, -0.00359255, 0.0160895   ]];

